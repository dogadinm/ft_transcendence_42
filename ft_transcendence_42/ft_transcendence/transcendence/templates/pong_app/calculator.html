
{% extends "pong_app/layout.html" %}
{% block body %}
<body>
    <textarea name="ta" id="results" cols="30" rows="10">

    </textarea><br>
    Enter the expression: <input type="text" id="exp">
    <input type="button" id="submit" value="Get Results">
    <script>
        const socket = new WebSocket('ws://localhost:8000/ws/livec/');
        if (socket.readyState === WebSocket.OPEN) {
            console.log("Work");
        } else {
            console.log(socket);
        }
        socket.onmessage = (e) => {
            result = JSON.parse(e.data).result;
            document.getElementById("results").value += "Server: " + result + "\n";
        }

        socket.onclose = (e) => {
            console.log("Socket closed!");
        }

        document.querySelector('#exp').onkeyup = function (e) {
            if (e.keyCode === 13) {  // enter, return
                document.querySelector('#submit ').click();
            }
        };

        document.querySelector("#submit").onclick = (e) => {
            inputfield = document.querySelector("#exp")
            exp = inputfield.value
            console.log("Socket sending soon");
            console.log(socket);
            socket.send(JSON.stringify(
                {
                    expression: exp
                }
            ))
            document.querySelector("#results").value += "You: " + exp + "\n";
            inputfield.value = "";
        }

    </script>
</body>



{% endblock %}
